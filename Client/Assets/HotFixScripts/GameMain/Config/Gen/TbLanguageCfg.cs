
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using Framework;
using System;
using System.IO;

namespace cfg
{
    public partial class TbLanguageCfg : TableBase
    {
        private System.Collections.Generic.Dictionary<int, LanguageCfg> _dataMap;
        private System.Collections.Generic.List<LanguageCfg> _dataList;
        private Func<string, MemoryStream> _streamLoader;
        private string _fileName;
    
        public override void Initialize(string name, Func<string, MemoryStream> streamLoader)
        {
            _fileName = name;
            _streamLoader = streamLoader;
            _dataMap = new System.Collections.Generic.Dictionary<int, LanguageCfg>();
            _dataList = new System.Collections.Generic.List<LanguageCfg>();
            LoadAll();
        }

        private void LoadAll()
        {
            var stream = _streamLoader?.Invoke($"{_fileName}.bytes");
            var byteBuf = new ByteBuf(stream.ToArray());
            for (int n = byteBuf.ReadSize(); n > 0; --n)
            {
                LanguageCfg v;
                v = global::cfg.LanguageCfg.DeserializeLanguageCfg(byteBuf);
                _dataList.Add(v);
                _dataMap.Add(v.Id, v);
            }
        }
    
        public System.Collections.Generic.Dictionary<int, LanguageCfg> DataMap => _dataMap;
        public System.Collections.Generic.List<LanguageCfg> DataList => _dataList;
    
        public LanguageCfg Get(int key) => _dataMap.TryGetValue(key, out var v) ? v : null;
    
    }

}

